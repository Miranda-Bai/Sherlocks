An _EVTX file_ is an event log generated by various services, processes, and programs on Windows operating system.
```
└─$ EVTDIR=/home/kali/HTB/sherlocks/ILikeTo/Triage/uploads/auto/C%3A/Windows/System32/winevt/Logs/Security.evtx 
└─$ chainsaw hunt -s /opt/chainsaw/sigma -r /opt/chainsaw/rules -m /opt/chainsaw/mappings/sigma-event-logs-all.yml $EVTDIR -o security.chainsaw
```
![[Pasted image 20240124184329.png]]
```
└─$ chainsaw dump $EVTDIR -o security.json --json
```
## security.chainsaw RDP login

^068386

![[Pasted image 20240125220404.png]]
2023-07-12 11:11:18
12/07/2023 11:11:18 ^c8bbb9
## moveitsvc Password changes
![[Pasted image 20240125220907.png]]
4724
```
└─$ du -hs security.json        
36M     security.json
```
```json
$ jq '.[] | select(.Event.System.EventID == 4724) | {Time:.Event.System.TimeCreated_attributes.SystemTime, Subject:.Event.EventData.SubjectUserName, Target:.Event.EventData.TargetUserName}' security.json 
{
  "Time": "2023-06-14T07:13:49.111325Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-14T09:21:11.011138Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T08:17:31.373433Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "Administrator"                                                                                         
}                                                                                                                   
{
  "Time": "2023-07-12T08:34:24.566230Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "dfir"                                                                                                  
}                                                                                                                   
{
  "Time": "2023-07-12T11:09:27.864823Z",                                                                            
  "Subject": "moveitsvc",                                                                                           
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T10:01:06.010582Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T10:57:56.502339Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T15:53:07.187058Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}
```

```json
$ jq '.[] | select(.Event.System.EventID == 4724 and .Event.EventData.TargetUserName == "moveitsvc") | {Time:.Event.System.TimeCreated_attributes.SystemTime, Subject:.Event.EventData.SubjectUserName, Target:.Event.EventData.TargetUserName}' security.json
{
  "Time": "2023-06-14T07:13:49.111325Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-14T09:21:11.011138Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-07-12T11:09:27.864823Z",                                                                            
  "Subject": "moveitsvc",                                                                                           
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T10:01:06.010582Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T10:57:56.502339Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}                                                                                                                   
{
  "Time": "2023-06-13T15:53:07.187058Z",                                                                            
  "Subject": "Administrator",                                                                                       
  "Target": "moveitsvc"                                                                                             
}  
```
2023-07-12T11:09:27
12/07/2023 11:09:27 ^15cddc
````bash
$ jq '.[] | select(.Event.System.EventID == 4724 and .Event.EventData.TargetUserName == "moveitsvc") | {Time:.Event.System.TimeCreated_attributes.SystemTime, Subject:.Event.EventData.SubjectUserName, Target:.Event.EventData.TargetUserName}' security.json | jq -s 'sort_by(.Time)'
```
